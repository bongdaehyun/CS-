# 쿠키와 세션

## 쿠키

웹사이트에 접속할 때 생성되는 정보를 담은 임시파일

서버가 사용자의 웹 브라우저에 저장하는 데이터를 말함

Key : value로 구성 , String 형태로 이루어져 있음

- 이름, 값, 만료일(저장 기간 설정), 경로 정보로 구성되어 있다.
- 클라이언트에 총 300개의 쿠키를 저장할 수 있다.
- 하나의 도메인 당 20개의 쿠키를 가질 수 있다
- 하나의 쿠키는 4KB(=4096byte)까지 저장 가능하다.

> 브라우저마다 저장되는 쿠키는 다릅니다. (크롬으로 남긴 쿠키는 인터넷 익스플로어에서 사용할 수 없습니다.)
서버에서는 브라우저가 다르면 다른 사용자로 인식합니다.

![%E1%84%8F%E1%85%AE%E1%84%8F%E1%85%B5%E1%84%8B%E1%85%AA%20%E1%84%89%E1%85%A6%E1%84%89%E1%85%A7%E1%86%AB%20c36b0d5ae02c4b128b9833295f86708a/Untitled.png](%E1%84%8F%E1%85%AE%E1%84%8F%E1%85%B5%E1%84%8B%E1%85%AA%20%E1%84%89%E1%85%A6%E1%84%89%E1%85%A7%E1%86%AB%20c36b0d5ae02c4b128b9833295f86708a/Untitled.png)

쿠키는 `세션 쿠키(Session Cookie)` 와 `지속 쿠키(Persistent Cookie)` 로 나뉜다.

만료 날짜/시간을 지정하지 않으면, '메모리에 있는 동안' 계속 유효하다고 판단하도록 세션 쿠키에 저장되고, 만료 날짜/시간을 지정하면 프로세스가 종료되더라도(메모리에서 사라지더라도) 특정 만료날짜/시간까지 유효하므로 지속 쿠키에 저장된다.

세션 쿠키는 브라우저 메모리에 저장되므로 브라우저가 종료되면 쿠키는 사라지게 된다.

지속 쿠키는 파일로 저장되므로 브라우저가 종료되어도 쿠키는 남아있게 된다.

### 사용 목적

1. **세션 관리**(Session Management) : 로그인, 사용자 닉네임, 접속 시간, 장바구니 등의 서버가 알아야할 정보들을 저장합니다.
2. **개인화**(Personalization) : 사용자마다 다르게 그 사람에 적절한 페이지를 보여줄 수 있습니다.
3. **트래킹**(Tracking) : 사용자의 행동과 패턴을 분석하고 기록합니다.

### 단점

1. 방문했던 웹 사이트에 대한 정보 및 개인정보가 기록되기 때문에 사생활을 침해할 소지가 있으며, 이를 해소하기 위해서 웹 브라우저 자체에 쿠키 거부 기능이 있습니다. 
이러한 쿠키에 대한 거부가 웹 브라우저에 설정되어 있으면,
쿠키 본래의 목적인 웹 브라우저와의 연결을 지속시키는 기능을 수행할 수 없는 경우가 발생합니다.
2. 서버가 가지고 있는 것이 아니라 사용자에게 저장되기 때문에, 임의로 고치거나 지울 수 있고, 가로채기도 쉬워 보안이 취약합니다. 따라서 , 쿠키에는 민감하거나 중요한 정보를 담는 것은 위험합니다.

## 세션

세션 아이디는 웹 브라우저 당 1개씩 생성되어 웹 컨테이너에 저장되며 브라우저 종료시 소멸

- 웹 서버에 웹 컨테이너의 상태를 유지하기 위한 정보를 저장한다.
- 웹 서버의 저장되는 쿠키(=세션 쿠키)
- 브라우저를 닫거나, 서버에서 세션을 삭제했을때만 삭제가 되므로,쿠키보다 비교적 보안이 좋다.
- 저장 데이터에 제한이 없다.(서버 용량이 허용하는 한...)
- 각 클라이언트 고유 Session ID를 부여한다.Session ID로 클라이언트를 구분하여 각 클라이언트 요구에 맞는 서비스 제공

### 단점

세션은 서버에 저장되고, 서버자원을 사용하기 때문에 사용자가 많을 경우 소모되는 자원이 상당하다.

## 쿠키와 세션 차이

![%E1%84%8F%E1%85%AE%E1%84%8F%E1%85%B5%E1%84%8B%E1%85%AA%20%E1%84%89%E1%85%A6%E1%84%89%E1%85%A7%E1%86%AB%20c36b0d5ae02c4b128b9833295f86708a/Untitled%201.png](%E1%84%8F%E1%85%AE%E1%84%8F%E1%85%B5%E1%84%8B%E1%85%AA%20%E1%84%89%E1%85%A6%E1%84%89%E1%85%A7%E1%86%AB%20c36b0d5ae02c4b128b9833295f86708a/Untitled%201.png)

## 토큰 기반 인증

토큰 기반의 인증 시스템은 인증받은 사용자들에게 토큰을 발급하고, 서버에 요청을 할 때 헤더에 토큰을 함께 보내도록 하여 유효성 검사를 한다. 이러한 시스템에서는 더이상 사용자의 인증 정보를 서버나 세션에 유지하지 않고 클라이언트 측에서 들어오는 요청만으로 작업을 처리한다. 즉, 서버 기반의 인증 시스템과 달리 상태를 유지하지 않으므로 Stateless한 구조를 갖는다. 이러한 토큰 기반의 인증 방식을 통해 수많은 문제점들을 해결할 수 있는데, 대표적으로 사용자가 로그인이 되어있는지 안되어있는지 신경쓰지 않고 손쉽게 시스템을 확장할 수 있다.

![%E1%84%8F%E1%85%AE%E1%84%8F%E1%85%B5%E1%84%8B%E1%85%AA%20%E1%84%89%E1%85%A6%E1%84%89%E1%85%A7%E1%86%AB%20c36b0d5ae02c4b128b9833295f86708a/Untitled%202.png](%E1%84%8F%E1%85%AE%E1%84%8F%E1%85%B5%E1%84%8B%E1%85%AA%20%E1%84%89%E1%85%A6%E1%84%89%E1%85%A7%E1%86%AB%20c36b0d5ae02c4b128b9833295f86708a/Untitled%202.png)

### 이점

1. 무상태성& 확장성

    토큰은 클라이언트 측에 저장되기 때문에 서버는 완전히 Stateless, 클라이언트와 서버의 연결고리가 없기 때문에 확장하기 매우 적합

2. 보안성
3. 확장성
4. 여러 플롯폼 및 도메인